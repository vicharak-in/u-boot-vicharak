// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
/*
 * Copyright (c) 2023 Vicharak India
 *
 */

/dts-v1/;
#include "rk3588.dtsi"
#include "rk3588-u-boot.dtsi"
#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/input/input.h>
#include <dt-bindings/pinctrl/rockchip.h>

/ {
	model = "Vicharak RK3588 AXON VO.1";
	compatible = "vicharak,rk3588-axon", "rockchip,rk3588";

	aliases {
		mmc0 = &sdhci;
		mmc1 = &sdmmc;
		serial2 = &uart2;
	};

	chosen {
		stdout-path = "serial2:1500000n8";
	};
	// Regulators: {{{
	vcc12v_dcin: vcc12v-dcin {
		u-boot,dm-pre-reloc;
		compatible = "regulator-fixed";
		regulator-name = "vcc12v_dcin";
		regulator-always-on;
		regulator-boot-on;
		regulator-min-microvolt = <12000000>;
		regulator-max-microvolt = <12000000>;
	};

	vcc5v0_sys: vcc5v0-sys {
		u-boot,dm-pre-reloc;
		compatible = "regulator-fixed";
		regulator-name = "vcc5v0_sys";
		regulator-always-on;
		regulator-boot-on;
		regulator-min-microvolt = <5000000>;
		regulator-max-microvolt = <5000000>;
		vin-supply = <&vcc12v_dcin>;
	};

	vcc5v0_typec1: vcc5v0-typec1-regulator {
		u-boot,dm-pre-reloc;
		compatible = "regulator-fixed";
		regulator-name = "vcc5v0_typec1";
		regulator-min-microvolt = <5000000>;
		regulator-max-microvolt = <5000000>;
		enable-active-high;
		gpio = <&pca9554 PCA_IOE_4 GPIO_ACTIVE_HIGH>;
		vin-supply = <&vcc5v0_sys>;
	};

	vcc5v0_typec0: vcc5v0-typec0-regulator {
		u-boot,dm-pre-reloc;
		compatible = "regulator-fixed";
		regulator-name = "vcc5v0_typec0";
		regulator-min-microvolt = <5000000>;
		regulator-max-microvolt = <5000000>;
		enable-active-high;
		gpio = <&pca9554 PCA_IOE_6 GPIO_ACTIVE_HIGH>;
		vin-supply = <&vcc5v0_sys>;
	};

	vcc3v3_pca9554: vcc3v3-pca9554 {
		u-boot,dm-pre-reloc;
		compatible = "regulator-fixed";
		regulator-name = "vcc3v3_pca9554";
		regulator-min-microvolt = <3300000>;
		regulator-max-microvolt = <3300000>;
		regulator-boot-on;
		regulator-always-on;
		enable-active-high;
		vin-supply = <&vcc5v0_sys>;
	};
	// End of Regulators }}}

	// Leds: {{{
	gpio_leds: gpio-leds {
		u-boot,dm-pre-reloc;
		compatible = "gpio-leds";
		status = "okay";
		pinctrl-names = "default";
		pinctrl-0 = <&power_led_gpio &status_led_gpio>;

		power_led: power-led {
			u-boot,dm-pre-reloc;
			label = "power";
			gpios = <&gpio0 RK_PA0 GPIO_ACTIVE_HIGH>;
			default-state = "on";
			retain-state-suspend;
			linux,default-trigger = "default-on";
		};

		status_led: status-led {
			u-boot,dm-pre-reloc;
			label = "status";
			gpios = <&gpio0 RK_PB2 GPIO_ACTIVE_HIGH>;
			default-state = "on";
			retain-state-suspend;
			linux,default-trigger = "heartbeat";
		};
	};
	// End of Leds }}}
};

// I2C6: {{{
&i2c6 {
	u-boot,dm-pre-reloc;
	status = "okay";

	// PCA9554 GPIO Expander
	pca9554: gpio@24 {
		u-boot,dm-pre-reloc;
		compatible = "nxp,pca9554";
		reg = <0x24>;
		vcc-supply = <&vcc3v3_pca9554>;
		gpio-controller;
		#gpio-cells = <2>;
		gpio-group-num = <300>;
		status = "okay";
	};
};
// End of I2C6 }}}

// Pinctrl: {{{
&pinctrl {
	// Leds: {{{
	leds {
		power_led_gpio: power-led-gpio {
			rockchip,pins =
						<0 RK_PA0 RK_FUNC_GPIO &pcfg_pull_none>;
		};

		status_led_gpio: status-led-gpio {
			rockchip,pins =
						<0 RK_PB2 RK_FUNC_GPIO &pcfg_pull_none>;
		};
	};
	// End of Leds }}}
};
// End of Pinctrl }}}

// SDHCI: {{{
&sdhci {
	max-frequency = <200000000>;
	no-sdio;
	no-sd;
	bus-width = <8>;
	non-removable;
	mmc-hs400-1_8v;
	mmc-hs400-enhanced-strobe;
	status = "okay";
};
// End of SDHCI }}}

// SDMMC: {{{
&sdmmc {
	max-frequency = <200000000>;
	no-sdio;
	no-mmc;
	bus-width = <4>;
	cap-mmc-highspeed;
	cap-sd-highspeed;
	disable-wp;
	sd-uhs-sdr104;
	status = "okay";
};
// End of SDMMC }}}

// UART2: {{{
&uart2 {
	pinctrl-0 = <&uart2m0_xfer>;
	status = "okay";
};
// End of UART2 }}}
